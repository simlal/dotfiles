# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'catppuccin/tmux#v2.1.3' # See https://github.com/catppuccin/tmux/tags for additional tags
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-battery'


######### PREFIX #########
# Set prefix to Ctrl+Space 
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

######### GENERAL SETTINGS #########
# Enable mouse support
set -g mouse on

# Default to zsh
set -g default-shell /usr/bin/zsh

# Set default terminal
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Start windows and panes at 1
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when a window is closed
set -g renumber-windows on

# Increase scrollback buffer size
set -g history-limit 50000

# Enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# Faster command sequences
set -s escape-time 10

# Refresh status line every 60 seconds
set -g status-interval 60

######### THEME - CATPPUCCIN FRAPPE #########
set -g @catppuccin_flavor 'frappe'
set -g @catppuccin_window_text " #W"
set -g @catppuccin_window_current_text " #W"

# Disable Catppuccin's right modules so we can build our own
set -g @catppuccin_status_modules_right ""

### pane focus/dimming and border indicator
set -g @catppuccin_pane_background_color "#{@thm_mantle}"
set -g @catppuccin_pane_active_border_style "fg=#{@thm_teal},bold"
set -g @catppuccin_pane_border_style "fg=#{@thm_overlay_0}"
set -g pane-border-lines heavy

# Status bar position
set -g status-position top
set -g status-left ""
set -g status-right-length 200

set -g status-right '#{?client_prefix,#[bg=#{@thm_red}#,fg=#{@thm_crust}#,bold#,blink] ‚å® PREFIX #[default],} \
#{?window_zoomed_flag,#[bg=#{@thm_yellow}#,fg=#{@thm_crust}] üîç #[default],} \
#[bg=#{@thm_mauve},fg=#{@thm_crust}] #S #[default] \
#[bg=#{@thm_teal},fg=#{@thm_crust}] ÔÑ† #{pane_current_command} #[default] \
#[bg=#{@thm_blue},fg=#{@thm_crust}] ÔÑï #{b:pane_current_path} #[default] \
#[bg=#{@thm_green},fg=#{@thm_crust}] ÔÄó %H:%M #[default]'

# Make unfocused panes dimmer
set -g pane-border-lines heavy


######### KEYBINDINGS #########

# Reload config
bind , source-file ~/.tmux.conf \; display "Config reloaded!"

# New tab/windows 
bind t new-window
bind n new-window

# Tab navigation 
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9
bind '[' previous-window
bind ']' next-window

# Close tab/window
bind w kill-window

# Move tabs (windows)
bind < swap-window -d -t -1
bind > swap-window -d -t +1

# Rename window
bind-key r command-prompt -I "#W" "rename-window '%%'"

# Splits / panes
bind x kill-pane
bind '\' split-window -h -c "#{pane_current_path}"  # vertical split (right)
bind - split-window -v -c "#{pane_current_path}"    # horizontal split (down)
bind z resize-pane -Z  # toggle zoom
bind -n C-M-p display-panes

# Split navigation 
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Split resizing 
bind -n C-M-h resize-pane -L 3
bind -n C-M-l resize-pane -R 3
bind -n C-M-k resize-pane -U 3
bind -n C-M-j resize-pane -D 3
bind = select-layout even-horizontal  # equalize splits

# Scrolling 
bind -n S-Up if -F "#{pane_in_mode}" \
    "send-keys -X scroll-up" \
    "copy-mode -e; send-keys -X scroll-up"

bind -n S-Down if -F "#{pane_in_mode}" \
    "send-keys -X scroll-down" \
    "send-keys -X scroll-down"

bind -n S-PageUp if -F "#{pane_in_mode}" \
    "send-keys -X page-up" \
    "copy-mode -e; send-keys -X page-up"

bind -n S-PageDown if -F "#{pane_in_mode}" \
    "send-keys -X page-down" \
    "send-keys -X page-down"

# Copy mode settings
setw -g mode-keys vi
bind v copy-mode -e
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle

# Open scrollback in editor 
set-environment -g EDITOR "nvim"
set-environment -g VISUAL "nvim"
bind s capture-pane -S - -E - \; \
    save-buffer /tmp/tmux-capture.txt \; \
    new-window "sh -c '\$EDITOR /tmp/tmux-capture.txt'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# ‚îÄ‚îÄ Catppuccin Frappe pane focus + dimming ‚îÄ‚îÄ

