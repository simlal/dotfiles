# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-battery'


######### PREFIX #########
# Set prefix to Ctrl+Space 
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

######### GENERAL SETTINGS #########
# Enable mouse support
set -g mouse on

# Default to zsh
set -g default-shell /usr/bin/zsh

# Set default terminal
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Start windows and panes at 1
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when a window is closed
set -g renumber-windows on

# Increase scrollback buffer size
set -g history-limit 50000

# Enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# Faster command sequences
set -s escape-time 10

# Refresh status line every 60 seconds
set -g status-interval 60

######### THEME - CATPPUCCIN FRAPPE #########
# Colors based on catppuccin-frappe
thm_bg="#303446"
thm_fg="#c6d0f5"
thm_cyan="#81c8be"
thm_black="#292c3c"
thm_gray="#414559"
thm_magenta="#ca9ee6"
thm_pink="#f4b8e4"
thm_red="#e78284"
thm_green="#a6d189"
thm_yellow="#e5c890"
thm_blue="#8caaee"
thm_orange="#ef9f76"
thm_black4="#626880"

# Status bar
set -g status-position top
set -g status-style "bg=$thm_bg,fg=$thm_fg"
set -g status-left-length 100
set -g status-right-length 100

# Window status
setw -g window-status-style "bg=$thm_bg,fg=$thm_fg"
setw -g window-status-current-style "bg=$thm_orange,fg=$thm_bg,bold"
setw -g window-status-activity-style "bg=$thm_red,fg=$thm_bg"

# Window status format
setw -g window-status-format " #I:#W "
setw -g window-status-current-format " #I:#W "

# Pane borders (matching split-divider-color)
set -g pane-border-style "fg=$thm_gray"
set -g pane-active-border-style "fg=$thm_orange"

# Message styling
set -g message-style "bg=$thm_orange,fg=$thm_bg"
set -g message-command-style "bg=$thm_orange,fg=$thm_bg"

# Status left and right
set -g status-left "#[bg=$thm_blue,fg=$thm_bg,bold] #S #[bg=$thm_bg,fg=$thm_blue] "
set -g status-right "#[fg=$thm_orange]#[bg=$thm_orange,fg=$thm_bg] %Y-%m-%d %H:%M #[bg=$thm_bg,fg=$thm_orange]"

######### KEYBINDINGS #########

# Reload config
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# New tab/windows 
bind t new-window
bind n new-window

# Tab navigation 
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9
bind '[' previous-window
bind ']' next-window

# Close tab/window
bind w kill-window

# Move tabs (windows)
bind < swap-window -d -t -1
bind > swap-window -d -t +1

# Splits 
bind x kill-pane
bind '\' split-window -h -c "#{pane_current_path}"  # vertical split (right)
bind - split-window -v -c "#{pane_current_path}"    # horizontal split (down)
bind z resize-pane -Z  # toggle zoom

# Split navigation 
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Split resizing 
bind -n C-M-h resize-pane -L 5
bind -n C-M-l resize-pane -R 5
bind -n C-M-k resize-pane -U 5
bind -n C-M-j resize-pane -D 5
bind = select-layout even-horizontal  # equalize splits

# Scrolling 
bind -n S-Up if -F "#{pane_in_mode}" \
    "send-keys -X scroll-up" \
    "copy-mode -e; send-keys -X scroll-up"

bind -n S-Down if -F "#{pane_in_mode}" \
    "send-keys -X scroll-down" \
    "send-keys -X scroll-down"

bind -n S-PageUp if -F "#{pane_in_mode}" \
    "send-keys -X page-up" \
    "copy-mode -e; send-keys -X page-up"

bind -n S-PageDown if -F "#{pane_in_mode}" \
    "send-keys -X page-down" \
    "send-keys -X page-down"

# Copy mode settings
setw -g mode-keys vi
bind v copy-mode -e
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle

# Open scrollback in editor 
set-environment -g EDITOR "nvim"
set-environment -g VISUAL "nvim"
bind s capture-pane -S - -E - \; \
    save-buffer /tmp/tmux-capture.txt \; \
    new-window "sh -c '\$EDITOR /tmp/tmux-capture.txt'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
